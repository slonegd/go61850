{
  "package": "cotp",
  "description": "Connection-Oriented Transport Protocol (COTP) implementation according to ISO 8073, used in IEC 61850 for data transmission over TCP/IP",
  "imports": [
    "context",
    "errors",
    "fmt",
    "io",
    "log"
  ],
  "interfaces": {
    "Logger": {
      "methods": [
        {"name": "Debug", "signature": "Debug(format string, v ...any)"}
      ],
      "description": "Interface for logging COTP packets"
    }
  },
  "types": {
    "Connection": {
      "type": "struct",
      "description": "Represents COTP connection",
      "fields": [
        {"name": "state", "type": "int", "private": true},
        {"name": "remoteRef", "type": "int", "private": true},
        {"name": "localRef", "type": "int", "private": true},
        {"name": "protocolClass", "type": "int", "private": true},
        {"name": "conn", "type": "io.ReadWriteCloser", "private": true},
        {"name": "options", "type": "Options", "private": true},
        {"name": "isLastDataUnit", "type": "bool", "private": true},
        {"name": "payload", "type": "[]byte", "private": true},
        {"name": "writeBuffer", "type": "[]byte", "private": true},
        {"name": "readBuffer", "type": "[]byte", "private": true},
        {"name": "packetSize", "type": "uint16", "private": true},
        {"name": "socketExtBuffer", "type": "[]byte", "private": true},
        {"name": "socketExtFill", "type": "int", "private": true},
        {"name": "logger", "type": "Logger", "private": true}
      ],
      "methods": [
        {"name": "GetTpduSize", "signature": "GetTpduSize() int", "description": "Returns TPDU size in bytes"},
        {"name": "SetTpduSize", "signature": "SetTpduSize(tpduSize int)", "description": "Sets TPDU size in bytes"},
        {"name": "GetRemoteRef", "signature": "GetRemoteRef() int", "description": "Returns remote reference"},
        {"name": "GetLocalRef", "signature": "GetLocalRef() int", "description": "Returns local reference"},
        {"name": "GetPayload", "signature": "GetPayload() []byte", "description": "Returns payload buffer"},
        {"name": "ResetPayload", "signature": "ResetPayload()", "description": "Resets payload buffer"},
        {"name": "FlushBuffer", "signature": "FlushBuffer() error", "description": "Flushes extension buffer"},
        {"name": "SendConnectionRequestMessage", "signature": "SendConnectionRequestMessage(params *IsoConnectionParameters) error", "description": "Sends connection request message (client side)"},
        {"name": "SendConnectionResponseMessage", "signature": "SendConnectionResponseMessage() error", "description": "Sends connection response message (server side)"},
        {"name": "ParseIncomingMessage", "signature": "ParseIncomingMessage() (Indication, error)", "description": "Parses incoming message"},
        {"name": "SendDataMessage", "signature": "SendDataMessage(payload []byte) error", "description": "Sends data message with automatic fragmentation"},
        {"name": "ReadToTpktBuffer", "signature": "ReadToTpktBuffer(ctx context.Context) (TpktState, error)", "description": "Reads data into TPKT buffer, checks context before blocking read operations"}
      ]
    },
    "TSelector": {
      "type": "struct",
      "description": "Represents transport selector",
      "fields": [
        {"name": "Value", "type": "[]byte"}
      ]
    },
    "Options": {
      "type": "struct",
      "description": "Represents COTP connection options",
      "fields": [
        {"name": "TSelSrc", "type": "TSelector"},
        {"name": "TSelDst", "type": "TSelector"},
        {"name": "TpduSize", "type": "uint8", "description": "TPDU size as power of two"}
      ]
    },
    "IsoConnectionParameters": {
      "type": "struct",
      "description": "Represents ISO connection parameters",
      "fields": [
        {"name": "RemoteTSelector", "type": "TSelector"},
        {"name": "LocalTSelector", "type": "TSelector"}
      ]
    },
    "Indication": {
      "type": "int",
      "description": "Represents result of COTP operation",
      "constants": [
        {"name": "IndicationOK", "value": 0, "description": "Operation successful"},
        {"name": "IndicationError", "value": 1, "description": "Error"},
        {"name": "IndicationConnect", "value": 2, "description": "Connection indication"},
        {"name": "IndicationData", "value": 3, "description": "Data indication"},
        {"name": "IndicationDisconnect", "value": 4, "description": "Disconnect indication"},
        {"name": "IndicationMoreFragmentsFollow", "value": 5, "description": "More fragments follow"}
      ]
    },
    "TpktState": {
      "type": "int",
      "description": "Represents TPKT packet reading state",
      "constants": [
        {"name": "TpktPacketComplete", "value": 0, "description": "Packet fully read"},
        {"name": "TpktWaiting", "value": 1, "description": "Waiting for data"},
        {"name": "TpktError", "value": 2, "description": "Read error"}
      ]
    },
    "ConnectionOption": {
      "type": "func(*connectionOptions)",
      "description": "Function type for Connection configuration options"
    }
  },
  "constants": {
    "tpktRFC1006HeaderSize": {"value": 4, "type": "int"},
    "cotpDataHeaderSize": {"value": 3, "type": "int"},
    "cotpMaxTpduSize": {"value": 8192, "type": "int"},
    "defaultPayloadBufferSize": {"value": 8192, "type": "int"},
    "defaultReadBufferSize": {"value": 8192, "type": "int"},
    "defaultWriteBufferSize": {"value": 8192, "type": "int"},
    "defaultSocketExtBufferSize": {"value": 8192, "type": "int"}
  },
  "functions": [
    {
      "name": "NewConnection",
      "signature": "NewConnection(conn io.ReadWriteCloser, opts ...ConnectionOption) *Connection",
      "description": "Creates new COTP connection"
    },
    {
      "name": "WithPayloadBufferSize",
      "signature": "WithPayloadBufferSize(size int) ConnectionOption",
      "description": "Sets payload buffer size"
    },
    {
      "name": "WithReadBufferSize",
      "signature": "WithReadBufferSize(size int) ConnectionOption",
      "description": "Sets read buffer size"
    },
    {
      "name": "WithWriteBufferSize",
      "signature": "WithWriteBufferSize(size int) ConnectionOption",
      "description": "Sets write buffer size"
    },
    {
      "name": "WithSocketExtBufferSize",
      "signature": "WithSocketExtBufferSize(size int) ConnectionOption",
      "description": "Sets socket extension buffer size"
    },
    {
      "name": "WithLogger",
      "signature": "WithLogger(logger Logger) ConnectionOption",
      "description": "Sets logger for debugging"
    }
  ]
}

